% (Written responses must be typeset and in pdf. Only one member of the group
% (should submit to the appropriate dropbox on Learn.)

% Due Mon, July 21, 11:59:59 PM

\documentclass[a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{upgreek}
\usepackage{svg}
\usepackage{todonotes}

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\title{ECE457A Assignment 4}
\author{
  Group 27 \\
  \\
  Lucas Wojciechowski, Ariel Weingarten, Alexander Maguire, \\
  Austin Dobrik, Dane Carr}
\date{\today}

\begin{document}

\maketitle

\section{Question 1}
\subsection{Givens}
Objective Function: $ F(x_o,y_o)=minf_i^2$\\\\
$f_i=\sum_{i=1}^3(r_i - \sqrt{(x_i-x_o)^2 + (y_i-y_o)^2})$\\\\
Value of $w$ : 0.792\\\\
Value of $c_1$ : 1.5\\\\
Value of $c_2$ : 1.5\\\\
Beacon 1: $r_1=4$ and $(x_1,y_1)=(1,1)$\\\\
Beacon 2: $r_1=6.5$ and $(x_2,y_2)=(2,2)$\\\\
Beacon 3: $r_1=8$ and $(x_3,y_3)=(3,3)$\\\\
Particle 1: $(x_0^1,y_0^1)=(1,0)$\\\\
Particle 2: $(x_0^2,y_0^2)=(0.5,1.25)$\\\\

\subsection{Iteration 1}
\subsubsection{Particle 1}
\begin{align*}
(x_0^1,y_0^1) &= (1,0)\\
F(1,0) &= \sum_{i=1}^3(r_i - \sqrt{(x_i-1)^2 + (y_i-0)^2})^2\\
F(1,0) &= (4 - \sqrt{ (1-1)^2 + (1-0)^2 })^2 + (6.5 - \sqrt{ (2-1)^2 + (2-0)^2 })^2 + (8 - \sqrt{ (3-1)^2 + (3-0)^2 })^2\\
F(1,0) &\approx 55.56
\end{align*}

\subsubsection{Particle 2}
\begin{align*}
(x_0^2,y_0^2) &= (0.5,1.25)\\
F(0.5,1.25) &= \sum_{i=1}^3(r_i - \sqrt{(x_i-0.5)^2 + (y_i-1.25)^2})^2\\
F(0.5,1.25) &= (4 - \sqrt{ (1-0.5)^2 + (1-1.25)^2 })^2 + (6.5 - \sqrt{ (2-0.5)^2 + (2-1.25)^2 })^2 \\
            &\qquad + (8 - \sqrt{ (3-0.5)^2 + (3-1.25)^2 })^2\\
F(0.5,1.25) &\approx 59.58
\end{align*}

\subsubsection{Outcome}
The global best comes from Particle 1. The best solution thus far is $(x_0, y_0) = (1,0)$.
\[
	gbest_0 = 55.56
\]

Now we can calculate the new velocities using $r_1=0.3$ and $r_2=0.9$

\begin{align*}
v_{1x}^1 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(1-1) + 1.5\cdot0.9\cdot(1-1) = 0\\
v_{1y}^1 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(0-0) + 1.5\cdot0.9\cdot(0-0) = 0\\
v_{1x}^2 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(0.5-0.5) + 1.5\cdot0.9\cdot(1-0.5) = 0.675\\
v_{1y}^2 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(1.25-1.25) + 1.5\cdot0.9\cdot(0-1.25) = -1.68\\
\end{align*}

\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
    % Header
    \hline
    $(x_0^i,y_0^i)$ & $(v_{0x}^i,v_{0y}^i)$ & $pbest_0^i$ & $(v_{1x}^i,v_{1y}^i)$ & $(x_1^i,y_1^i)$ \\ \hline
    % Data
    (1,0) & (0,0) & (1,0) & (0,0) & (1,0) \\ \hline
    (0.5, 1.25) & (0,0) & (0.5, 1.25) & (0.675,-1.68) & (1.175,-0.43) \\ \hline
    \end{tabular}
\end{center}

\subsection{Iteration 2}
\subsubsection{Particle 1}
Nothing has changed for particle one.
\begin{align*}
(x_0^1,y_0^1) &= (1,0)\\
F(1,0) &= \sum_{i=1}^3(r_i - \sqrt{(x_i-1)^2 + (y_i-0)^2})^2\\
F(1,0) &= (4 - \sqrt{ (1-1)^2 + (1-0)^2 })^2 + (6.5 - \sqrt{ (2-1)^2 + (2-0)^2 })^2 + (8 - \sqrt{ (3-1)^2 + (3-0)^2 })^2\\
F(1,0) &\approx 55.56
\end{align*}

\subsubsection{Particle 2}
\begin{align*}
(x_0^2,y_0^2) &= (1.175,-0.43)\\
F(1.175,-0.43) &= \sum_{i=1}^3(r_i - \sqrt{(x_i-1.175)^2 + (y_i--0.43)^2})^2\\
F(1.175,-0.43) &= (4 - \sqrt{ (1-1.175)^2 + (1+0.43)^2 })^2 + (6.5 - \sqrt{ (2-1.175)^2 + (2+0.43)^2 })^2\\
			   & \qquad + (8 - \sqrt{ (3-1.175)^2 + (3+0.43)^2 })^2\\
F(1.175,-0.43) &\approx 38.96
\end{align*}

\subsubsection{Outcome}
The global best comes from Particle 2. The best solution thus far is $(x_0, y_0) = (1.175,-0.43)$.
\[
	gbest_1 = 38.96
\]

Now we can calculate the new velocities using $r_1=0.4$ and $r_2=0.7$

\begin{align*}
v_{1x}^1 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(1-1) + 1.5\cdot0.9\cdot(1.175-1) = 0.184\\
v_{1y}^1 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(0-0) + 1.5\cdot0.9\cdot(-0.43-0) = -0.452\\
v_{1x}^2 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(1.175-1.175) + 1.5\cdot0.9\cdot(1.175-1.175) = 0\\
v_{1y}^2 &= 0.792\cdot0 + 1.5\cdot0.3\cdot(-0.43 - (-0.43)) + 1.5\cdot0.9\cdot(-0.43 - (-0.43)) = -0\\
\end{align*}

\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
    \hline
    $(x_1^i,y_1^i)$ & $(v_{1x}^i,v_{1y}^i)$ & $pbest_1^i$ & $(v_{2x}^i,v_{2y}^i)$ & $(x_2^i,y_2^i)$ \\ \hline
    (1,0) & (0,0) & (1,0) & (0.184,-0.452) & (1.184, -0.452 ) \\ \hline
    (1.175,-0.43) & (0.675,-1.68) & (1.175,-0.43) & (0,0) & (1.175,-0.43) \\ \hline
    \end{tabular}
\end{center}

\subsection{Conclusions}
After two iterations we have two candidate solutions. Particle 1 yields a more optimal solution and that will be the solution that we pick.\\
Calculations below.

\subsubsection{Particle 1}
\begin{align*}
(x_2^1,y_2^1) &= (1.184,-0.452)\\
F(1.184,-0.452) &= \sum_{i=1}^3(r_i - \sqrt{(x_i-1.184)^2 + (y_i-(-0.452))^2})^2\\
F(1.184,-0.452) &= (4 - \sqrt{ (1-1.184)^2 + (1-(-0.452))^2 })^2 + (6.5 - \sqrt{ (2-1.184)^2 + (2-(-0.452))^2 })^2\\
                & \qquad + (8 - \sqrt{ (3-1.184)^2 + (3-(-0.452))^2 })^2\\
F(1.184,-0.452) &\approx 38.57
\end{align*}

\subsubsection{Particle 2}
Nothing has changed for Particle 2.
\begin{align*}
(x_0^2,y_0^2) &= (1.175,-0.43)\\
F(1.175,-0.43) &= \sum_{i=1}^3(r_i - \sqrt{(x_i-1.175)^2 + (y_i--0.43)^2})^2\\
F(1.175,-0.43) &= (4 - \sqrt{ (1-1.175)^2 + (1+0.43)^2 })^2 + (6.5 - \sqrt{ (2-1.175)^2 + (2+0.43)^2 })^2\\
               & \qquad + (8 - \sqrt{ (3-1.175)^2 + (3+0.43)^2 })^2\\
F(1.175,-0.43) &\approx 38.96
\end{align*}


\section{Question 2}

Initialize the graph with $\uptau = \alpha = \beta = Q = 1$, $\rho = 0.7$. The values of $\alpha$, $\beta$ were chosen to be 1 because we were unable to find any literature on ``good'' values of the parameters which described the ACS algorithm exactly as defined in class.

\subsection{Iteration 1}

Compute the selection probability $\eta_1^1$:
$$
\eta_1^1 = \sum_{n \in N_1} \frac{\uptau_{1n}^\alpha}{d_{1n}^\beta} = \frac{1}{4} + \frac{1}{2} + \frac{1}{9} + \frac{1}{12} = 0.95
$$

Compute $p_{1i}^1 \quad \forall i \in V$:
\begin{align*}
p_{1i}^1 &= \frac{\uptau_{1n}d_{1i}^{-1}}{\eta_1^1} \\
\\
p_{12}^1 &= 0.26 \\
p_{13}^1 &= 0.53 \\
p_{14}^1 &= 0.12 \\
p_{15}^1 &= 0.08
\end{align*}

Select a new node from $N_1$ based on the relative percentages $p_{1i}^1$. In the preparation of this paper, the authors called $rand()$, which returned $p_{15}^1$. Thus, we will next go to node 5.

$$
\text{Tour}^1 = \{1, 5\} \qquad
d_{tour}^1 = 12
$$

Now compute $\eta_5^1$:
$$
\eta_5^1 = \sum_{n \in N_5 \setminus \{1\}} \frac{\uptau_{5n}^\alpha}{d_{5n}^\beta} = \frac{1}{5} + \frac{1}{10} + \frac{1}{3} = 0.63
$$

Again, compute the relative percentages $p_{5i}^1$:
\begin{align*}
p_{52}^1 &= 0.32 \\
p_{53}^1 &= 0.16 \\
p_{54}^1 &= 0.53
\end{align*}

$rand()$ now choses $p_{54}^1$; select node 4 as the next step on the route.

$$
\text{Tour}^1 = \{1, 5, 4\} \qquad
d_{tour}^1 = 15
$$

For the sake of brevity, we will continue on with the math, marking taken paths in \textbf{bold face}.

$$
\eta_4^1 = \sum_{n \in N_4 \setminus \{1,5\}} \frac{\uptau_{4n}^\alpha}{d_{4n}^\beta} = \frac{1}{5} + \frac{1}{4} = 0.45
$$

\begin{align*}
p_{42}^1 &= 0.44 \\
\mathbf{p_{43}^1} &= \mathbf{0.56}
\end{align*}

$$
\text{Tour}^1 = \{1, 5, 4, 3\} \qquad
d_{tour}^1 = 19
$$

$$
\mathbf{p_{32}^1} = \mathbf{1}
$$

$$
\text{Tour}^1 = \{1, 5, 4, 3, 2, 1\} \qquad
d_{tour}^1 = 30
$$

Now evaporate the pheromone over the graph:

$$
\uptau_{ij} = (1 - \rho) \uptau_{ij}
$$

$$ \uptau_{ij} = \begin{tabular}{r | c c c c}
$i \setminus j$ & 2 & 3 & 4 & 5 \\ \hline
1 & 0.3 & 0.3 & 0.3 & 0.3 \\
2 &     & 0.3 & 0.3 & 0.3 \\
3 &     &     & 0.3 & 0.3 \\
4 &     &     &     & 0.3
\end{tabular}
$$

And update the tour with the pheromone left by the ant:

$$\uptau_{update} = \frac{Q}{d_{tour}^1} = 0.033$$

$$ \uptau_{ij} = \begin{tabular}{r | c c c c}
$i \setminus j$ & 2 & 3 & 4 & 5 \\ \hline
1 & 0.33 & 0.3 & 0.3 & 0.33 \\
2 &     & 0.33 & 0.3 & 0.3 \\
3 &     &     & 0.33 & 0.3 \\
4 &     &     &     & 0.33
\end{tabular}
$$

\subsection{Iteration 2}

$$
\eta_1^1 = \sum_{n \in N_1} \frac{\uptau_{1n}^\alpha}{d_{1n}^\beta} = \frac{0.33}{4} + \frac{0.3}{2} + \frac{0.3}{9} + \frac{0.33}{12} = 0.29
$$

\begin{align*}
p_{1i}^2 &= \frac{\uptau_{1i} d_{1i}^{-1}}{\eta_1^1} \\
\\
p_{12}^2 &= 0.28 \\
\mathbf{p_{13}^2} &= \mathbf{0.51} \\
p_{14}^2 &= 0.11 \\
p_{15}^2 &= 0.09
\end{align*}

$$
\text{Tour}^2 = \{1, 3\} \qquad
d_{tour}^2 = 2
$$

$$
\eta_3^2 = \sum_{n \in N_3\setminus\{1\}} \frac{\uptau_{3n}^\alpha}{d_{3n}^\beta} = \frac{0.33}{7} + \frac{0.33}{4} + \frac{0.3}{10} = 0.16
$$

\begin{align*}
\mathbf{p_{32}^2} &= \mathbf{0.29} \\
p_{34}^2 &= 0.52 \\
p_{35}^2 &= 0.19
\end{align*}

$$
\text{Tour}^2 = \{1, 3, 2\} \qquad
d_{tour}^2 = 9
$$

$$
\eta_2^2 = \sum_{n \in N_2\setminus\{1,3\}} \frac{\uptau_{2n}^\alpha}{d_{2n}^\beta} = \frac{0.3}{5} + \frac{0.3}{5} = 0.12
$$

\begin{align*}
p_{24}^2 &= 0.50 \\
\mathbf{p_{25}^2} &= \mathbf{0.20}
\end{align*}

$$
\text{Tour}^2 = \{1, 3, 2, 5, 4, 1\} \qquad
d_{tour}^2 = 26
$$

$$
\uptau_{ij} = (1 - \rho) \uptau_{ij}
$$

$$ \uptau_{ij} = \begin{tabular}{r | c c c c}
$i \setminus j$ & 2 & 3 & 4 & 5 \\ \hline
1 & 0.23 & 0.21 & 0.21 & 0.23 \\
2 &      & 0.23 & 0.21 & 0.21 \\
3 &      &      & 0.23 & 0.21 \\
4 &      &      &      & 0.23
\end{tabular}
$$

$$\uptau_{update} = \frac{Q}{d_{tour}^2} = 0.038$$

$$ \uptau_{ij} = \begin{tabular}{r | c c c c}
$i \setminus j$ & 2 & 3 & 4 & 5 \\ \hline
1 & 0.23 & 0.25 & 0.25 & 0.23 \\
2 &      & 0.28 & 0.21 & 0.21 \\
3 &      &      & 0.23 & 0.21 \\
4 &      &      &      & 0.28
\end{tabular}
$$

\end{document}
