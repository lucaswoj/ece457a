% SOW must be emailed to the course instructor at akhamis@pami.uwaterloo.ca
% with subject SOW-[Your Project number] no later than June 9, 2014.

% (We are team #27)

\documentclass[a4paper]{article}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage{amssymb}

\title{Complex Task Allocation: A Comparison of Metaheuristics}
\author{
	Group 27 \\
	\\
	Lucas Wojciechowksi, Ariel Weingarten, Alexander Maguire, \\
	Austin Dobrik, Dane Carr}
\date{\today}

\begin{document}

\maketitle

\section*{Summary}

% The summary should be a brief version of the full report It should give the
% reader an accurate overview Be brief, but be specific.

\section{Introduction}

% Summarize the importance of the problem you are trying to solve and the reason
% that motivated you to select this project. Explain what was the problem or
% challenge that you were given? state the purpose of the project and how did
% you solve it? Enumerate the objectives of the project and describe in brief
% the structure of the report.

% Complex Task Allocation Problem: In mobile surveillance systems, complex
% task allocation addresses how to optimally assign a set of surveillance
% tasks to a set of mobile sensing agents to maximize overall expected
% performance, taking into account the priorities of the tasks and the skill
% ratings of the mobile robots.

\section{Literature Review}

% Conduct a critical survey on different/similar solutions and explain how your
% solution extends or differs from these solutions.

% This project should start by studying comprehensively the problem in order
% to characterize its complexity and its main challenges. Collect related
% resources and conduct a critical survey on similar solutions reported in the
% literature.

% Collect resources and think about how to explain any of the topics below
%  - Motivation
%  - Definition
%  - [*] Categorization
%  - Challenges
%  - Applications

% Suggested reference papers:
%
%  - Alaa Khamis, Ahmed Elmogy and Fakhreddine Karray, "Complex Task Allocation
%    in Mobile Surveillance Systems," Journal of Intelligent and Robotic Systems,
%    Springer
%  - Mohamed Badreldin, Ahmed Hussein and Alaa Khamis, "A Comparative Study
%    between Optimization and Market-based Approaches to Multi-robot Task
%    Allocation," Advances in Artificial Intelligence Journal, 2013.
%  - Alaa Khamis, Cooperative Multirobot Systems, Plenary Talk at IAC2014].

\section{Problem Formulation and Modeling}

% Include the problem statement and describe its model.

% In this step, an initial statement of the problem should be made. The
% internal and external factors and the objective(s) of the problem must be
% outlined. Describe the problem as standard optimization problem as
% following:
%
% Find
% $$X = {x_1, x_2, ..., x_n}^T$$
% which minimizes/maximizes $f(X)$ subject to equality constraints
% $$\forall j \in [1, m], l_j(X) = 0$$
% and inequality constraints
% $$\forall j \in [1, p], g_j(X) \leq 0$$
% (see "specification for statement of work.pdf" for a visual representation)
%
% Define the decision variable or design vector, objective function/s and the
% problem constraints.

% Include the problem statement and describe its modeling If you think there is
% a need to explain background information regarding some supplementary methods
% used in your formulation, do that here

Suppose we have a number of mobile $\mathit{robot}$s
$$\mathit{robots} = \{ \mathit{robot}_i | i \in [1, n_\mathit{robots}] \}$$

Using these $\mathit{robot}$s, we are to perform a number of tasks
$$\mathit{tasks} = \{ \mathit{task}_i | i \in [1, n_\mathit{tasks}] \}$$

Each task has a $\mathit{priority}$
$$\text{priority}(\mathit{task}_i) \in [0 ,1]$$

$\mathit{robot}$s are not homogeneous; some are more ``skilled" at certain tasks than others
$$\text{skill}(\mathit{robot}_i, \mathit{task}_j) \in [0 ,1]$$

Tasks are located some distance each other
$$\mathit{distance}(\mathit{task}_i, \mathit{task}_j) > 0 \in \mathbb{R}$$

Each $\mathit{robot}$ starts at some location, its $\mathit{depot}$. $\mathit{robot}_i$ starts at $\mathit{depot}_i$

Each $\textit{depot}$ is located a certain distance from each task.
$$\mathit{distance}(\mathit{depot}_i, \mathit{task}_j)$$

$\mathit{task}$s are assigned to $\mathit{robot}$s.
$$\mathit{task}_j \rightarrow \mathit{robot}_i$$

We seek, for each $\mathit{robot}$, a path through the $\mathit{task}$s such that each $\mathit{task}$ is performed exactly once and our overall cost is minimized.

A solution, $S$, consists of a mapping of $\mathit{robot}$s to paths through $\mathit{task}$s.
$$S(\mathit{robot}_i) = \{\mathit{task}_0, \mathit{task}_1, ..., \mathit{task}_n\}$$



\subsubsection{Cost Function}




The cost of some path, $S(i)$ is given by
$$
\text{cost}(S(i)) = w(i, S(i,|S(i)|), S(i,0)) + \sum_{t = 0}^{|S(i)|-1} w(i, S(i,t), S(i,t+1))
$$

% TODO does not not naturally follow from our cost function?
Subject to the constraint
$$
n \notin S(i) \quad \text{if} \quad M_{skill}(i, n) = 0
$$

Therefore, the overall performance of a solution is:

$$
\sum_{i \in \mathit{robot}} \text{cost}_i
$$

Our weighted-distance function is defined as follows:
$$
w(i, \mathit{src}, \mathit{dst}) = \begin{cases}
(\alpha - \text{priority}(\mathit{dst}))^\gamma \times (\beta - \text{skill}(i, \mathit{dst})) \times \text{distance}(\mathit{src}, \mathit{dst}) & \mathit{dst} \ne S(i,0) \\
\text{distance}(\mathit{src}, \mathit{dst}) & \text{otherwise}
\end{cases}
$$

where $\alpha, \beta \geq 1$. These parameters are to ensure that the priority and skill factors are aligned with the minimization of the function.

$\gamma$ is used to tweak the relative importance of a task's priority, and has no constraints on it.

The $\text{distance}(\mathit{src}, \mathit{dst})$ function makes use of $D_\text{task-task}$, $D_\text{depot-task}$, and $D_\text{task-depot}$. $D_\text{task-task}$ is a square matrix that contains the distances between tasks i.e. the distance between task i and j is found at $D_\text{task-task}(i,j)$. $D_\text{depot-task}$ contains the distances from depots to tasks i.e. the distance from depot i to task j is $D_\text{task-task}(i,j)$. $D_\text{task-depot}$ contains the distances from the tasks to the depots i.e. the distance from task i to depot j is $D_\text{task-depot}(i,j)$

The $\text{priority}(\mathit{dst})$ function makes use of $P$. $P$ is a vector where the priority of $\text{task}_i$ is contained in $P(i)$.

The $\text{skill}(i, \mathit{dst})$ function makes use of the matrix $M_{skill}$. The skill of $\text{robot}_i$ at performing $\text{task}_j$ is contained in $M_{skill}(i,j)$

\subsection{Modeling as Traveling Salesman Problem}

% In this important step, an abstract mathematical model is built for the
% problem. The modeler can be inspired by similar models in the literature.
% This will reduce the problem to well-studied optimization models. Usually,
% models we are solving are simplifications of the reality. They involve
% approximations and sometimes they skip processes that are complex to
% represent in a mathematical model. For example, travelling salesman problem
% (TSP) and multiple travelling salesman problem (mTSP) are commonly used as
% models for real-life problems such as school bus routing problem and complex
% task allocation problem.

Given a population of $\mathit{robots}$, a set of $\mathit{tasks}$, a set of $\mathit{depots}$ a priority for each task $P$, each robot's skill at performing each task $M_{skill}(r,t)$ and an ordered assignment of tasks to robots $S(r)$, for each $r \in \mathit{robots}$
we can create a directed, weighted graph as follows:

We will model complex task allocation loosely on the traveling salesman problem.

Given a random initial solution, $S_0$,

\begin{align*}
	G &= (V, E) \\
	V &= \mathit{depots} \cup \mathit{tasks} \\
	E_{task_i, task_j} &= D_\text{task-task}(i,j) \qquad \forall t \in \mathit{tasks} \\
  E_{depot_i, task_j} &= D_\text{depot-task}(i,j) \qquad \forall d \in \mathit{depots}\\
	E_{task_i, depot_j} &= D_\text{task-depot}(i,j) \qquad \forall d \in \mathit{depots}\\
\end{align*}
%

That is, we create a graph that shows the distances between every task and the distances between every task and every depot.

From here, we can run TSP on the created graph. The cost of taking each edge will be determined using $w$ which will take in the distance represented by that edge as an input. Every robot starts at their depot.

\section{Potential other model}

This is almost verbatim out of the literature.

\begin{align}
x_{ij} = \begin{cases}
      1 & \text{if arc(i,j) is used in the tour} \\
      0 & otherwise
   \end{cases} \\
\text{minimize} \sum_{i=1}^n \sum_{j=1}^n c_{ij} \times x_{ij} \\
\sum_{i=1}^n \sum_{j=1}^n &= n \\
\sum_{i \in S} \sum_{j \in S} x_{ij} \le |\text{SubTour}| - 1 \\
x_{ij} \in \{0, 1\},\qquad \forall (i, j) \in A \\
\forall \text{SubTour} \subseteq V \backslash \phi
\end{align}
\subsection{Reduced Size Problem}

% Describe a reduced version of the problem in order to be used to perform
% hand-iterations. For example, if you are studying plant layout problem
% (PLP), a reduced size problem may contain only 4 departments (facilities)
% and 4 locations.

% Describe a small scale problem of the original one Try to perform hand
% iterations to make sure modeling is done properly

In this section, we define a reduced size complex task allocation problem which
will be used to perform hand-iterations of various optimization algorithms in
the following sections.

Suppose we have 2 robots
$$\mathit{robots} = \left\{ \mathit{robot}_0, \mathit{robot}_1 \right\}$$

These robots must collectively perform 3 tasks
$$\mathit{tasks} = \left\{ \mathit{task}_0, \mathit{task}_1,  \mathit{task}_2 \right\}$$

The priority of each task is

\begin{tabular}{llll}
$\mathit{task}_0$  & 0.1 \\
$\mathit{task}_1$  & 0.2 \\
$\mathit{task}_2$  & 0.3 \\
\end{tabular}
\vspace{1.5em}

The skill of each robot  at each task is

\begin{tabular}{llll}
                   & $\mathit{task}_0$ & $\mathit{task}_1$ & $\mathit{task}_2$ \\
$\mathit{robot}_0$ & 0.1               & 0.4               & 0.5               \\
$\mathit{robot}_1$ & 0.2               & 0.3               & 0.6               \\
\end{tabular}
\vspace{1.5em}

The distances between tasks are

\begin{tabular}{llll}
                   & $\mathit{task}_0$ & $\mathit{task}_1$ & $\mathit{task}_2$ \\
$\mathit{task}_0$  & 0                 & 0.1               & 0.2               \\
$\mathit{task}_1$  & 0.1               & 0                 & 0.3               \\
$\mathit{task}_2$  & 0.2               & 0.3               & 0                 \\
\end{tabular}
\vspace{1.5em}

Each robot, $\mathit{robot}_i$, starts at a depot, $\mathit{depot}_i$. The
distance from each depot to each task is

\begin{tabular}{llll}
                   & $\mathit{task}_0$ & $\mathit{task}_1$ & $\mathit{task}_2$ \\
$\mathit{depot}_0$ & 0.6               & 0.3               & 0.1               \\
$\mathit{depot}_1$ & 0.5               & 0.4               & 0.2               \\
\end{tabular}
\vspace{1.5em}

As an initial solution, we will use
$$S = [0, 1, \mathit{sentinel}, 2 ]$$
Which specifies the paths
\begin{align*}
\mathit{robot}_0: & \mathit{depot}_0 \rightarrow \mathit{task}_0 \rightarrow \mathit{task}_1 \rightarrow  \mathit{depot}_0
\mathit{robot}_1: & \mathit{depot}_1 \rightarrow \mathit{task}_2 \rightarrow \mathit{depot}_1
\end{align*}

\subsection{Real Problem}

% The real size problem formulation and modeling will be used to show the
% ability of the proposed solutions implemented in handling large size
% problems.

% Gradually Increase the size of problem to study the scalability of your model
% Some models will fail in this step (any examples? Is the any way to know that
% beforehand?)

\section{Proposed Solution}

% Once the problem is formulated and modeled, the five main algorithms studied
% in this course (TA, SA, GA, PSO and ACO) must be applied to generate a “good”
% solution for the problem. The solution may be optimal or suboptimal.

% At least two hand iterations must be performed on the reduced size problem to
% show how to use the studied algorithms in solving the selected problem.

% The studied algorithms must be implemented from scratch using Matlab/Octave
% without using any toolboxes.

%  - Generate an initial solution.
%  - Suggest a cost function (objective function) suitable for this problem.
%  - Define a suitable neighborhood operator.
%  - Define a suitable solving strategy for this problem.
%  - Select your own values for the parameter and explain the basis for your
%      selection.
%  - Describe how each algorithm (TS, SA, GA, PSO and ACO) will proceed to
%       solve this problem by performing at least two hand iterations on a
%       reduced version of the problem.
%  - Implement the proposed solution using Matlab/Octave.

% Once the problem is formulated and modeled, the five main algorithms studied
% in this course (TA, SA, GA, PSO and ACO) must be applied to generate a “good”
% solution for the problem. The solution may be optimal or suboptimal.

% Apply five main optimization algorithms (TS, SA, GA, PSO, and ACO) Try to
% generate a “good” solution that may be optimal or sub-optimal

% Include at least two hand iterations on the reduced size of the problem The
% studied algorithms should be implemented from scratch in Matlab / Octave.
% Using toolboxes are NOT allowed.

\subsection{Taboo Search Algorithm} % Lucas

\subsection{Simulated Annealing Algorithm} % Dane

\subsection{Genetic Algorithm} % Austin

\subsection{Particle Swarm Optimization Algorithm} % Ariel

\subsection{Ant Colony Optimization Algorithm} % Sandy

\section{Performance Evaluation}

% Define some experiments (scenarios) to quantitatively evaluate the performance
% of your algorithm. Experiments must be run several times and average results
% should be reported

% Establish a set of evaluation metrics and run some experiments with different
% values of algorithm parameters to quantitatively and qualitatively assess the
% performance of the developed solution using different meta-heuristic
% optimization techniques. Students must identify the pros and cons of each
% technique and assess the quality of work as well as its fit with project
% objectives.

% Report your observation and interpret the obtained results. Suggest how to
% refine the implemented solutions to improve their performance.

% The implemented solutions should be tested against a set of well-defined
% evaluation metrics. These metrics may include, but are not limited to, the CPU
% time of the algorithm, number of iterations to converge, time per iteration,
% optimality (if the ground truth is known), etc.

% A number of experiments/scenarios should be conducted to quantitatively
% evaluate the performance of the proposed solutions. You should run each
% experiment several times and report the average results.

% Determine some evaluation metrics (time is a potentially useful candidate) Run
% some experiments with different values of algorithms parameters to
% quantitatively and qualitatively assess the performance of the developed
% solution Identify the pros and cons of each method

\section{Conclusions \& Recommendations}

% Report your observation and interpret obtained results. Briefly explain your
% research work, and suggest how to improve the implemented solutions

% Summarize the conclusion and future improvement. Explain how did you solve the
% problem, what problems were met? What did the results show? and how to refine
% the proposed solution? You may organize ideas using lists or numbered points,
% if appropriate, but avoid making your report into a check-list or a series of
% encrypted notes.

\section{References}

% Every report needs references; in fact, your failure to consult references for
% guidance may be considered negligence. On the other hand, when you include
% sentences, photos, drawings or figures from other sources in your report, the
% complete reference must be cited. Failure to do so is plagiarism, an academic
% infraction with serious consequences.

% Remember to cite anything you get from other sources
%  - Other research papers
%  - Drawings, charts, figures, etc.

% Failure to do so is plagiarism, an academic infraction with serious
% consequences. The complete references should be shown at the end of your
% report

\end{document}
