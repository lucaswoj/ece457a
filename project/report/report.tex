% SOW must be emailed to the course instructor at akhamis@pami.uwaterloo.ca
% with subject SOW-[Your Project number] no later than June 9, 2014.

% (We are team #27)

\documentclass[a4paper]{article}


\usepackage[style=ieee,sorting=none,dateabbrev=false,backend=biber]{biblatex}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage{amssymb}
\usepackage{upgreek}
\usepackage{todonotes}
\usepackage{csquotes}

\addbibresource{report.bib}

% Allow for sub^3sections and sub^4sections
% http://pleasemakeanote.blogspot.com/2010/06/how-to-activate-subsubsubsection-in.html
\setcounter{secnumdepth}{5}
\newcommand{\subsubsubsection}[1]{\paragraph{#1} \mbox{}}
\newcommand{\subsubsubsubsection}[1]{\subparagraph{#1} \mbox{}}

\newcommand\Forall{\mathop{\mbox{\Large $\mathsurround0pt\forall$}}}


\title{Complex Task Allocation: A Comparison of Metaheuristics}
\author{
	Group 27 \\
	\\
	Lucas Wojciechowksi, Ariel Weingarten, Alexander Maguire, \\
	Austin Dobrik, Dane Carr}
\date{\today}

\begin{document}

\maketitle

% TODO Write out all irrational numbers to 4 decimal points
% TODO Represent solutions as S_0^3
% TODO All tasks must be 1-indexed
% TODO All robots must be 1-indexed
% TODO We must use a consistent naming convention for robots/sensors, homes/homes, tasks
% TODO We must use a consistent formatting in representing solutions, esp sentinal values
% TODO Do number equations and reference them by their number

\section*{Summary}
% The summary should be a brief version of the full report It should give the
% reader an accurate overview Be brief, but be specific.
This report is an analysis of the efficacy of different meta-heuristic algorithms in solving a complex task allocation problem.
Complex task allocation is the assignment of complex and simple tasks to a group of robots. This report is taking an optimization-based approach to solve a multi-task robot, single-robot task, instantaneous assignment version of the multirobot task assignment problem that adopts a decompose-then allocate strategy to handle complex tasks.

Five meta-heuristic algorithms were tested for this report. They are: Taboo Search, Simulated Annealing, Genetic Algorithms, Particle Swarm Optimization, and Ant Colony Optimization.

These algorithms will be run on a dataset that INSERT DESCRIPTION OF THE DATASET HERE.

The results of experimentation are as follows. The algorithm that produced the most optimal solution in ITERATIONS is ALGORITHM.
If computation time needs to be minimized, then ALGORITHM is able to produce the most optimal solution in SMALLER NUMBER of ITERATIONS.

In conclusions, this report recommends the use of ALGORITHM.

\section{Introduction}
% Why is the problem important
\subsection{Problem Context}
As the digital revolution leaves the second digital wave behind, and embraces the robotics wave\cite{Talk}, it is becoming increasingly important to prepare for the multitude of situations where robots will be available to complete various tasks.

In particular, Multirobot Systems (MRS) are becoming a high interest subject. An MRS is a group of robots that are designed with the intent of performing a collective behavior.\\
There are numerous advantages associated with a group of simple robots over a single multi-purpose robot. For example, it is simpler to design a robust single purpose robot than a robot with multiple abilities and configurations. Simple designs tend to be more robust and lead to more reliable robots. Another source of reliability is that a group of robots can accommodate some degree of redundancy in composition.  In addition, many complex tasks are distributed over a large area and would be slow to accomplish with a single-agent system. Examples of problems that can be solved by MRSs are search and rescue in burning building, surveillance and space construction.\\

% What is the problem
\subsection{Multirobot Task Allocation}
This report is specifically considering the problem of Complex Task Allocation for an MRS where the tasks are related to surveillance. The problem statement reads as follows:\\
\blockquote{In mobile surveillance systems, complex task allocation addresses how to optimally assign a set of surveillance tasks to a set of mobile sensing agents to maximize overall expected performance, taking into account the priorities of the tasks and the skill ratings of the mobile robots.}
This problem is important to solve because areas under surveillance usually possess some degree of danger. Being able to replace human sentinels with robots has the potential to save the lives of the surveyors and of nearby civilians by providing advanced warning of incoming threats. The task allocation problem within the broader scope of surveillance is important because an optimal solution represents an effective assignment of robots to tasks and improves the overall efficacy of the MRS. Colloquially speaking, this report answers the question of ``which robot should perform which task?''\cite{Badreldin}


% Enumeration of report objectives and report structure
\subsection{Report Structure and Direction}
The purpose of this report is to categorize which meta-heuristic optimization techniques are effective within a given scenario. For example, which algorithms are better-suited for online analysis and which for offline analysis.
The report will continue with a review of existing literature and identifying the commonalities and differences with the solution presented in this report. Then we will present a problem formulation and model from which we will implement our algorithms. The paper then describes how the well-known Traveling Salesman Problem can be adjusted for use with Complex Task Allocation. From there, the report identifies the criteria upon which each meta heuristic technique's performance is evaluated. Then the results of running each technique are then presented against these performance criteria. From these results, conclusions are drawn and recommendations for future work are suggested.



%  [1] [Alaa Khamis, Cooperative Multirobot Systems, Plenary Talk at IAC2014]
%  [2]``Complex Task Allocation in Mobile Surveillance Systems'',
%  \cite{Badreldin} ``A comparative Study between Optimization and Market-based Approaches to Multi-robot Task Allocation''.
%  [4] A Framework For Studying Multirobot Task Allocation (mrs03.pdf)Brian P. Gerkey, Maja J. Mataric

% Summarize the importance of the problem you are trying to solve and the reason that motivated you to select this project. Explain what was the problem or challenge that you were given? state the purpose of the project and how did you solve it? Enumerate the objectives of the project and describe in brief the structure of the report.


\section{Literature Review}
% The following papers were reviewed to obtain some perspective on different approaches to complex task allocation:
% ``Complex Task Allocation in Mobile Surveillance Systems'', ``A comparative Study between Optimization and
% Market-based Approaches to Multi-robot Task Allocation''.

An examination of existing literature reveals two predominate schools of approach to solving Multirobot Task Allocation (MRTA). There are market-based and optimization-based approaches.
The market-based approach is inspired from the development of market economies that have developed in human societies.
Each robot is made analogous to an individual seeking profit within a market and as a result, effecting a redistribution of resources within the environment.
The optimization-based approach is rooted in mathematics rather than socio-economic observation.
The thrust is to identify an equation that captures the constrains contained in a problem and to find a solution that either maximizes the profit or minimizes the damage caused by a given solution.
The goal of this report is to perform a comparative study of meta-heuristic techniques and so this directs the attention of this paper onto an optimization-based approach for solving MRTA. Though Khamis et al. \cite{Khamis} propose a method for using a market-based approach to generate candidate solutions that that then fed into a meta-heuristic algorithm.\\

In \cite{Khamis} Khamis et al. describe a taxonomy for classifying MRTA problems examined in literature. From their taxonomy, the MRTA problem examined by this report has the following classifications:

\begin{enumerate}
\item Multi-task robots: Each robot is able to perform various tasks, and has a certain skill at each type of task.
\item Single-robot tasks: Each task can be completed by a single robot.
\item Instantaneous Assignment: The assignment of tasks to robots will be calculated once and will not be updated dynamically as the robots execute their given task list.
\end{enumerate}

The scope of this report will focus on a decompose-then allocate approach towards complex tasks. That is, all complex tasks will be broken up into subtasks that will then be assigned out to particular robots. This makes a strong assumption about the independence of the subtasks, but is not without precedence in the literature.\cite{Khamis}\\

In Gerkey's Framework for Studying Multirobot Task Allocation \cite{Gerkey}, he identifies MRTA as an instance of the Optimal Assignment Problem (OAP). The OAP considers $n$ workers who have various skills levels at $m$ jobs that must be completed and seeks a mapping of workers to jobs that optimizes overall performance. At first this seems like an ideal problem to map MRTA onto, but there are a few shortcomings for the particular instance of MRTA being studied in this report. Robots are not being assigned to a single task, but rather are given a tour of several tasks through a given area of interest. The importance of considering distance traveled in addition to the cost associated in a task-robot mapping make the Traveling Salesmen Problem a more natural problem to map this instance of MRTA onto.\\

% Contrast our approach to mTSP to \cite{Badreldin}'s approach to mTSP
% we make task completion time a per-robot value rather than a per-task value
This report makes use of the multiple Travelling Salesman Problem formulation as described by Badreldin, Hussein, and Khamis with some important differences. \cite{Badreldin} Instead of including an aging factor feature of the robots, an energy capacity feature has been identified to put a harder constraint on robot tour lengths. In addition, instead of considering a minimum task completion time that holds for all robots, each type of robot has its own task completion cdot. This explicitly decouples a robots skill at a task from the time it takes to complete the task. It also more accurately represents that different types of robots can have radically different methods for accomplishing the same task. To reconcile this change with the idea that tasks have certain requirements, a time of infinity is assigned to robots who lack any skill at a particular task.

% Conduct a critical survey on different/similar solutions and explain how your
% solution extends or differs from these solutions.

% This project should start by studying comprehensively the problem in order
% to characterize its complexity and its main challenges. Collect related
% resources and conduct a critical survey on similar solutions reported in the
% literature.

% Collect resources and think about how to explain any of the topics below
%  - Motivation
%  - Definition
%  - [*] Categorization
%  - Challenges
%  - Applications

% Suggested reference papers:
%
%  - Alaa Khamis, Ahmed Elmogy and Fakhreddine Karray, "Complex Task Allocation
%    in Mobile Surveillance Systems," Journal of Intelligent and Robotic Systems,
%    Springer
%  - Mohamed Badreldin, Ahmed Hussein and Alaa Khamis, "A Comparative Study
%    between Optimization and Market-based Approaches to Multi-robot Task
%    Allocation," Advances in Artificial Intelligence Journal, 2013.
%  - Alaa Khamis, Cooperative Multirobot Systems, Plenary Talk at IAC2014].

\section{Problem Formulation and Modeling}

% Include the problem statement and describe its model.

% In this step, an initial statement of the problem should be made. The
% internal and external factors and the objective(s) of the problem must be
% outlined. Describe the problem as standard optimization problem as
% following:
%
% Find
% $$X = {x_1, x_2, ..., x_n}^T$$
% which minimizes/maximizes $f(X)$ subject to equality constraints
% $$\forall j \in [1, m], l_j(X) = 0$$
% and inequality constraints
% $$\forall j \in [1, p], g_j(X) \leq 0$$
% (see "specification for statement of work.pdf" for a visual representation)
%
% Define the decision variable or design vector, objective function/s and the
% problem constraints.

% Include the problem statement and describe its modeling If you think there is
% a need to explain background information regarding some supplementary methods
% used in your formulation, do that here

\subsection{Problem Formulation}

% TODO explicitly indicate that everything is 1 indexed

Suppose we have a set of ``tasks", $\{1, 2, ..., n_\mathit{tasks}\}$, which need to be completed by a set of ``robots", $\{1, 2, ..., n_\mathit{robots}\}$.

We seek a ``solution", $S$, that consists of an assignment of each robot an ordered set of tasks for it to complete, a ``tour", such that each task is performed exactly once and our overall cost is minimized. Each tour begins and ends at the robot's ``home".
$$
\Forall_{r=0}^{n_\mathit{robots}}
S(r) = \{ \mathit{home}(r), t_1, t_2, ..., t_n, \mathit{home}(r) \}
$$

For simplicity, we represent homes as tasks.
$$\mathit{home}(r) = n_\mathit{tasks} + r$$

\subsubsection{Overall Cost}

We will consider a multi-objective cost function, $\mathit{cost}$, that accounts for
\begin{enumerate}
\item $\mathit{cost}_\mathit{time}$, how long it takes to complete all tasks, assuming the robots work in parallel
\item $\mathit{cost}_\mathit{energy}$, whether or not each robot is able to complete its tour before running out of ``energy"
\item $\mathit{cost}_\mathit{quality}$, how well the tasks are completed relative to their priorities
\end{enumerate}

We define overall $\mathit{cost}$ as a linear combination of these cost functions, introducing two constants, $\alpha$ and $\beta$.
$$
\mathit{cost}(S) =
  \alpha \beta \, \mathit{cost}_\mathit{time}(S) +
  (1-\alpha) \mathit{cost}_\mathit{quality}(S) +
  \mathit{cost}_\mathit{energy}(S)
$$

$\alpha$ is a tuning parameter allowing for the relative importance of quality vs time to be adjusted. $\alpha = 1$ places all emphasis on time; $\alpha = 0$ places all emphasis on quality.

$\beta$ is a normalization parameter that makes $\mathit{cost}_\mathit{time}$ directly comparable to $\mathit{cost}_\mathit{quality}$. It is discussed in further the next section.

\subsubsection{Time Cost}

The time it takes to travel between tasks is a function of ``distance" and ``velocity." Each robot, $r$, may travel at a different velocity, measured in units distance per units time.
$$\mathit{velocity}(r) > 0, \in \mathbb{R}$$
Each task, $t$, may be a different distance from each other task, $u$. For simplicity, we represent home locations as tasks.
$$\mathit{distance}(t, u) > 0, \in \mathbb{R}$$

Additionally, each robot, $r$ may complete each task, $t$, in a different amount of time.
$$\mathit{task \, time}(r, t) > 0, \in \mathbb{R}$$

The total amount of time it takes for a robot, $r$, to complete a tour, $o$, is given by
$$
\mathit{tour \, time}(r, o) =
  \left(
    \sum^{|o|}_{t=2} \mathit{distance}(t - 1, t) \cdot \mathit{velocity}(r)
  \right) +
  \left(
    \sum^{|o|}_{t=1} \mathit{task \, time}(r, t)
  \right)
$$

We define $\mathit{cost}_\mathit{time}$ as the amount of time it takes to complete all tasks, assuming the robots work in parallel; effectively the max tour time across all robots.
$$
\mathit{cost}_\mathit{time}(S) =
  \max_{r=1}^{n_\mathit{robots}}
  \mathit{tour \, time}(r, S(r))
$$

In the overall cost function, $\beta$ is a normalization parameter that makes $\mathit{cost}_\mathit{time}$ directly comparable to $\mathit{cost}_\mathit{quality}$. Because skills and priorities are bounded $\in [0, 1]$, we are garunteed that, for some tour $o$ and some robot $r$, $\mathit{cost}_\mathit{quality}(r, o) \in [0, |o|]$. To make $\mathit{cost}_\mathit{time}$ directly comparable to $\mathit{cost}_\mathit{quality}$, we must scale $\mathit{cost}_\mathit{time}$ using $\beta$ such that it has the same bounds, $\in [0, |o|]$. Such a $\beta$ may be calculated as
$$
\beta =
    \frac
      {n_\textit{robots}}
      {
        2 \cdot
        \max \left(
          \frac
            { \max\limits_{r=1}^{n_\mathit{robots}} \max\limits_{t=1}^{n_\mathit{tasks}} \mathit{distance}(r, t) }
            { \min\limits_{r=1}^{n_\mathit{robots}} \mathit{velocity}(r) },
          \max\limits_{r=1}^{n_\mathit{robots}} \max\limits_{t=1}^{n_\mathit{tasks}} \mathit{task \, time}(r, t)
        \right)
      }
$$

\subsubsection{Energy Cost}

Each robot, $r$, may be capable of a spending different amount of time on tour. One unit energy equates to the ability to spend one additional unit time on tour.
$$\mathit{energy}(r) > 0, \in \mathbb{R}$$

We define $\mathit{cost}_\mathit{energy}$ to evaluate to 0 if this hard constraint is met for all robots, and $\infty$ otherwise
$$
\mathit{cost}_\mathit{energy}(S) = \begin{cases}
0 & \text{if } \mathop{\forall}\limits_{r=0}^{n_\mathit{robots}} \mathit{energy}(r) \geq \mathit{tour \, time}(r, S(r)) \\
\infty & \text{otherwise}
\end{cases}
$$

\subsubsection{Quality Cost}

We define $\mathit{cost}_\mathit{quality}$ to represent the skill with which each task was done relative to that task's priority. This is quantified as the sum of all the products of the skill with which a task was done by the priority that task had.
$$
\mathit{cost}_\mathit{quality}(S) =
  \sum^{n_\mathit{robots}}_{r=1}
  \sum^{|S(r)|}_{t=1}
  1 - \mathit{priority}(r, t) \cdot \mathit{skill}(r)
$$
Since a performing a high priority task with a highly skilled robot is desirable and we want to treat minimize cost, we subtract the maximum possible value, 1, from the product of the priority and skill (recall that $\mathit{skill}(r) \in [1, 0]$ and $\mathit{priority}(r, t) \in [1, 0]$).

% \subsection{Normalization}

% Note that many of the above quantities ($\mathit{priority}$, $\mathit{skill}$, $\mathit{distance}$, $\mathit{velocity}$, and $\mathit{taskTime}$) must be $\in [0 ,1]$. Raw data must be normalized to be within this rage.

% This is trivial for $\mathit{priority}$ and $\mathit{skill}$: divide all
% priorities by the max priority. Skills may be treated likewise.

% Normalizing the $\mathit{distance}$, $\mathit{velocity}$, and
% $\mathit{taskTime}$, however, is a little more tricky.

% Suppose you have unnormalized $\mathit{distance}'$, $\mathit{velocity}'$, and
% $\mathit{taskTime}'$ Calculate $\beta$ as


% We can then obtain normalized $\mathit{distance}'$, $\mathit{velocity}'$, and
% $\mathit{task \, time}'$ as
% \begin{align*}
% \mathit{distance} & = \mathit{distance}' \cdot \frac{1}{\beta} \\
% \mathit{velocity} & = \mathit{velocity}' \cdot \frac{1}{\beta} \\
% \mathit{task \, time} & = \mathit{task \, time}' \cdot \frac{1}{\beta}
% \end{align*}

\subsection{Modeling as Traveling Salesman Problem (TSP)}

% In this important step, an abstract mathematical model is built for the
% problem. The modeler can be inspired by similar models in the literature.
% This will reduce the problem to well-studied optimization models. Usually,
% models we are solving are simplifications of the reality. They involve
% approximations and somecdot they skip processes that are complex to
% represent in a mathematical model. For example, travelling salesman problem
% (TSP) and multiple travelling salesman problem (mTSP) are commonly used as
% models for real-life problems such as school bus routing problem and complex
% task allocation problem.
\subsubsection{Adaptation}
The area of interest for the robots in the MRS can be represented as a two dimensional bounded space. Within this space, the location of tasks and robot home locations can be represented as a graph. As described in the previous section, the goal is to create an assignment of tasks to robots which minimizes the total cost of travel. This makes the MRTA problem a good fit for reduction to the mTSP problem. This report will be making use of some well-studied variations of mTSP \cite{Badreldin}.
\begin{enumerate}
\item \textbf{Salesmen starting node}: Robots are not guaranteed to start from the same node and must end their tour by returning to their starting node.
\item \textbf{Number of salesmen}: The number of robots can vary between instances of this problem, but is static for the duration of any given instance.
\item \textbf{City time frame}: Robots take a certain amount of time to complete a task and therefore spend a certain amount of time at a given node.
\item \textbf{Fair division of salesmen}: There are constraints on the maximum amount of work that a robot can perform on their tour and so the required traveling should be distributed amongst the available agents in a relatively fair manner as defined by the problem parameters.
\end{enumerate}

In an MRS, there is heterogeneity in robot composition. This requires the augmentation of the ``salesman'' idea to support some differentiating factors. This report has identified 3 main features:

\begin{enumerate}
\item \textbf{Velocity}: Each robot has a speed at which they travel between tasks.
\item \textbf{Energy}: Each robot has an energy capacity that restricts how long it can be away from its home node.
\item \textbf{Skill}: Each robot has a skill rating that represents its ability to complete a task.
\item \textbf{Task Completion Time}: Robots do not necessarily take the same amount requires a different amount of time to complete

\end{enumerate}

In this MRTA problem, there is also heterogeneity in the tasks that area assigned to visit. For this reason, the idea of ``cities'' have been augmented with the following features:

\begin{enumerate}
\item \textbf{Priority}: Some tasks are more important that others and should be considered first.
\end{enumerate}

The next section describes the graph that will be constructed for use with mTSP.

\subsubsection{The Graph}
Given a population of $\mathit{robots}$, a set of $\mathit{tasks}$, a set of $\mathit{homes}$ a priority for each task $P$, each robot's skill at performing each task $M_{skill}(r,t)$ and an ordered assignment of tasks to robots $S(r)$, for each $r \in \mathit{robots}$
we can create a directed, weighted graph as follows:

We will model complex task allocation loosely on the traveling salesman problem.

Given a random initial solution, $S_0$,

\begin{align*}
	G &= (V, E) \\
	V &= \mathit{homes} \cup \mathit{tasks} \\
	E_{task_i, task_j} &= D_\mathit{task-task}(i,j) \qquad \forall t \in \mathit{tasks} \\
  E_{home_i, task_j} &= D_\mathit{home-task}(i,j) \qquad \forall d \in \mathit{homes}\\
	E_{task_i, home_j} &= D_\mathit{task-home}(i,j) \qquad \forall d \in \mathit{homes}\\
\end{align*}
%

That is, we create a graph that shows the distances between every task and the distances between every task and every home.

From here, we can run TSP on the created graph. The cost of taking each edge will be determined using $w$ which will take in the distance represented by that edge as an input. Every robot starts at their home.

\subsection{Reduced Size Problem}

% Describe a reduced version of the problem in order to be used to perform
% hand-iterations. For example, if you are studying plant layout problem
% (PLP), a reduced size problem may contain only 4 departments (facilities)
% and 4 locations.

% Describe a small scale problem of the original one Try to perform hand
% iterations to make sure modeling is done properly

In this section, we define a reduced size complex task allocation problem which
will be used to perform hand-iterations of various optimization algorithms in
the following sections.

Suppose we have two robots with the following attributes:

\begin{center}
\begin{tabular}{lll}
        & \textbf{velocity} & \textbf{energy} \\
\textbf{robot 1} & 0.9146   & 58.2024          \\
\textbf{robot 2} & 0.6509   & 45.0418
\end{tabular}
\end{center}
\vspace{1em}

These robots must complete three tasks:

\begin{center}
\begin{tabular}{llllll}
                &                   & \textbf{robot 1} & \textbf{robot 1} & \textbf{robot 2} & \textbf{robot 2} \\
                & \textbf{priority} & \textbf{skill}   & \textbf{time}    & \textbf{skill}   & \textbf{time} \\
\textbf{task 1} & 0.7761            & 0.97195          & 2.5511           & 0.33896          & 6.1632        \\
\textbf{task 2} & 0.3663            & 0.46364          & 8.8416           & 0.44659          & 3.7353        \\
\textbf{task 3} & 0.8863            & 0.83202          & 6.1189           & 0.02791          & 3.0623
\end{tabular}
\end{center}
\vspace{1em}

The distances between tasks and home locations are:

\begin{center}
\begin{tabular}{llllll}
                & \textbf{task 1} & \textbf{task 2} & \textbf{task 3} & \textbf{home 1} & \textbf{home 2} \\
\textbf{task 1} &   -             & 3.7604          & 6.2783          & 9.3271          & 1.4957 \\
\textbf{task 2} & 8.0510          &   -             & 8.4473          & 1.3190          & 4.9917 \\
\textbf{task 3} & 3.2972          & 8.5977          &   -             & 8.5270          & 0.4359 \\
\textbf{home 1} & 2.5143          & 8.4739          & 4.6241          &    -            &    -   \\
\textbf{home 2} & 1.2170          & 6.1530          & 3.9628          &    -            &    -
\end{tabular}
\end{center}

\subsection{Real Problem}

% The real size problem formulation and modeling will be used to show the
% ability of the proposed solutions implemented in handling large size
% problems.

% Gradually Increase the size of problem to study the scalability of your model
% Some models will fail in this step (any examples? Is the any way to know that
% beforehand?)

\section{Proposed Solution}

% Once the problem is formulated and modeled, the five main algorithms studied
% in this course (TA, SA, GA, PSO and ACO) must be applied to generate a “good”
% solution for the problem. The solution may be optimal or suboptimal.

% At least two hand iterations must be performed on the reduced size problem to
% show how to use the studied algorithms in solving the selected problem.

% The studied algorithms must be implemented from scratch using Matlab/Octave
% without using any toolboxes.

%  - Generate an initial solution.
%  - Suggest a cost function (objective function) suitable for this problem.
%  - Define a suitable neighborhood operator.
%  - Define a suitable solving strategy for this problem.
%  - Select your own values for the parameter and explain the basis for your
%      selection.
%  - Describe how each algorithm (TS, SA, GA, PSO and ACO) will proceed to
%       solve this problem by performing at least two hand iterations on a
%       reduced version of the problem.
%  - Implement the proposed solution using Matlab/Octave.

% Once the problem is formulated and modeled, the five main algorithms studied
% in this course (TA, SA, GA, PSO and ACO) must be applied to generate a “good”
% solution for the problem. The solution may be optimal or suboptimal.

% Apply five main optimization algorithms (TS, SA, GA, PSO, and ACO) Try to
% generate a “good” solution that may be optimal or sub-optimal

% Include at least two hand iterations on the reduced size of the problem The
% studied algorithms should be implemented from scratch in Matlab / Octave.
% Using toolboxes are NOT allowed.

In this section, we will consider five metahuristics in the context of complex task allocation:
\begin{itemize}
\item taboo search algorithm
\item simulated annealing algorithm
\item genetic algorithm
\item particle swarm optimization algorithm
\item ant colony optimization algorithm
\end{itemize}

% TODO will we also discuss perf in this section?
In the following subsections, we will, for each metaheuristic, provide a brief
high level description of the algorithm, show and explain two ``hand iterations"
on the reduced problem, and provide a Matlab implementation.

All hand iterations will use $\alpha = 0.5$, treating time and quality costs
equally, and $\beta = 0.06979$, calculated as specified in section 3.2.1. Where applicable
we will use the ``randomly" selected initial solution, $S_0 = [ 1, 2, 0, 3 ]$.

\subsection{Tabu Search Algorithm} % Lucas

% TODO high level overview.

\subsubsection{Hand Iterations}

In these hand iterations, we will use a tabu tenure of 1 and and aspiration criteria that allows globally improving but tabu solutions to be considered.

\subsubsubsection{Iteration 1}

We begin with our randomly selected initial solution, and initial global best
$$S_\textit{best} = S_0 = [ 1, 2, 0, 3 ], \; \textit{cost}(S_\textit{best}) = 3.1617$$

Next, we find all neighboring solutions and evaluate the cost of each. No solutions are tabu yet because our tabu list is empty
\begin{center}
\begin{tabular}{lllll}
& \textbf{swap}   & \textbf{solution}    & \textbf{tabu?} & \textbf{cost}  \\
$S_{1,1}$ & $1,2$ & $[2, 1, 0, 3]$ & no & $3.8583$ \\
$S_{1,2}$ & $1,3$ & $[0, 2, 1, 3]$ & no & $\infty$ \\
$S_{1,3}$ & $1,4$ & $[3, 2, 0, 1]$ & no & $3.6619$ \\
$S_{1,4}$ & $2,3$ & $[1, 0, 2, 3]$ & no & $3.5146$ \\
$S_{1,5}$ & $2,4$ & $[1, 3, 0, 2]$ & no & $3.7910$ \\
$S_{1,6}$ & $3,4$ & $[1, 2, 3, 0]$ & no & $4.3288$ \\
\end{tabular}
\end{center}
\vspace{1.5em}

Observe that $S_{1,4}$ has the lowest cost and is not tabu. Therefore, we let
$$S_{1, \textit{best}} = S_{1,4} = [1, 0, 2, 3], \; \textit{cost}(S_{1, \textit{best}}) = 3.6619$$
However, $S_\textit{best}$ is not updated because $S_{1, \textit{best}}$'s cost is higher.

Since this solution was created by swapping elements 2 and 3 in $S_0$, we mark those in our tabu list with a tenure of 1
\begin{center}
\begin{tabular}{lllll}
\textbf{position} & 1 & 2 & 3 & 4 \\
\textbf{tenure}   & 0 & 1 & 1 & 0
\end{tabular}
\end{center}
\vspace{1.5em}

\subsubsubsection{Iteration 2}

We begin by finding all neighboring solutions of $S_{1, \text{best}} = [1, 0, 2, 3]$
\begin{center}
\begin{tabular}{lllll}
& \textbf{swap}   & \textbf{solution}    & \textbf{tabu?} & \textbf{cost}  \\
$S_{2,1}$ & $1,2$ & $[0, 1, 2, 3]$ & yes & 3.4210 \\
$S_{2,2}$ & $1,3$ & $[2, 0, 1, 3]$ & yes & 2.9759 \\
$S_{2,3}$ & $1,4$ & $[3, 0, 2, 1]$ & no  & 3.7690 \\
$S_{2,4}$ & $2,3$ & $[1, 2, 0, 3]$ & yes & 3.1617 \\
$S_{2,5}$ & $2,4$ & $[1, 3, 2, 0]$ & yes & 4.1556 \\
$S_{2,6}$ & $3,4$ & $[1, 0, 3, 2]$ & yes & 3.6494 \\
\end{tabular}
\end{center}
\vspace{1.5em}

Observe that $S_{2,2}$ has the lowest cost. Although this solution is tabu, it is has a lower cost than $S_\textit{best}$, so we allow it to become $S_{2, \textit{best}}$ and $S_\textit{best}$.

We decrement the tenure of all elements in the tabu list. Since this solution was created by swapping elements 1 and 3 in $S_{1, \textit{best}}$, we mark those in our tabu list with a tenure of 1

\begin{center}
\begin{tabular}{lllll}
\textbf{position} & 1 & 2 & 3 & 4 \\
\textbf{tenure}   & 1 & 0 & 1 & 0
\end{tabular}
\end{center}
\vspace{1.5em}

After two iterations, we have
$$S_{\text{best}} = [2, 0, 1, 3], \; \textit{cost}(S_{\text{best}}) = 2.9759$$

\subsection{Simulated Annealing Algorithm} % Dane

\subsubsection{Hand Iterations}

In these hand iterations, a geometric cooling schedule will be used with an initial temperature $T_0 = 3$ and cooling factor $\alpha_\textit{cooling} = 0.8$
$$T_i = T_0 \cdot \left( \alpha_\textit{cooling} \right)^{i - 1}$$

\subsubsubsection{Iteration 1}

We begin with our randomly selected initial solution
$$S_\textit{best} = S_0 = [ 1, 2, 0, 3 ], \; \mathit{cost}(S_0) = 3.1617$$
and swap two randomly selected elements (4 and 3) to create a neighboring
solution, $S_1$
$$S_1 = [ 1, 2, 3, 0 ], \; \mathit{cost}(S_1) = 4.3288$$

To decide whether or not $S_1$ should become $S_\textit{best}$, we calculate its
selection probability, $P_1$, as % TODO cite this formula?
\begin{align*}
P_i & =
\begin{cases}
  1 & \mathit{cost}(S_{i}) < \mathit{cost}(S_{i - 1}) \\
  e^{-\frac{\mathit{cost}(S_{i}) - \mathit{cost}(S_{i - 1})}{T_i}} & \text{otherwise}
\end{cases} \\
P_1 & = 0.6777
\end{align*}

$S_1$ becomes $S_\mathit{best}$ if and only if a randomly selected number,
$r \in [0, 1]$, makes the inequality $r < P_1$ true.

Suppose we choose $r = 0.3597$. Because $0.3597 < 0.6777$
$$S_\mathit{best} = S_1 = [ 1, 2, 3, 0 ], \; \mathit{cost}(S_\mathit{best}) = 4.3288$$

\subsubsubsection{Iteration 2}

We begin by swapping two randomly selected elements (1 and 3) in $S_\mathit{best}$
$$S_2 = [ 3, 2, 1, 0 ], \; \mathit{cost}(S_2) = 4.6092$$

We calculate this solution's selection probability to be $P_2 = 0.8897$

Suppose we choose $r = 0.6329$. Because $0.6329 < 0.8897$ is true
$$S_\mathit{best} = S_2 = [ 3, 2, 1, 0 ], \; \mathit{cost}(S_\mathit{best}) = 4.6092$$

\subsection{Genetic Algorithm} % Austin

\subsection{Particle Swarm Optimization Algorithm} % Ariel

\subsubsection{Hand Iterations}

% TODO don't say "in this course", find the actual citation.
As per the recommendations in this course, we set the following constants
\begin{align*}
c_1 = c_2 & = 1.4944 \\
w & = 0.792
\end{align*}

\subsubsubsection{Iteration 1}

Let $r_1 = 0.7426$ and $r_2 = 0.4276$ as random constants for this iteration.

We start with three randomly selected initial positions (solutions)
\begin{align*}
S_{1,1} = [1, 2, 0, 3], & \; cost(S_{1,1}) = 3.1617 \\
S_{1,2} = [3, 2, 0, 1], & \; cost(S_{1,2}) = 3.6619 \\
S_{1,3} = [1, 0, 3, 2], & \; cost(S_{1,3}) = 3.6494
\end{align*}

Observe that $S_{1,1}$ has the lowest initial score. This becomes our initial $S_\mathit{gbest}$.
$$S_\mathit{gbest} = [1, 2, 0, 3], \; cost(S_\mathit{gbest}) = 3.1617$$

For this algorithm, we track not only the best solution seen globally,
$S_\mathit{gbest}$, but the best solution seen by each particle, $i$, as
$S_{\mathit{lbest}, i}$.

% TODO create a proper citation to paper
For each position, $i$, we calculate
$v_{1,i}$ using the following equation. Note that we redefine the subtraction of
two positions, the addition of a velocity and a position, and the multiplication
of a velocity by a scalar as defined in M. Clerc's paper, ``Discrete Particle
Swarm Optimization."
$$
v_{j,i} =
  w v_{j-1, i} +
  c_1 r_1 (S_{\mathit{lbest}, i} - S_{j-1, i}) +
  c_2 r_2 (S_\mathit{gbest} - S_{j-1, i})
$$

\begin{center}
\begin{tabular}{lllllll}
          & \textbf{position} & \textbf{cost} & \textbf{lbest position} & \textbf{lbest cost} & $v_1$ & $v_2$            \\
$S_{1,1}$ & $[1, 2, 0, 3]$    & $3.1617$      & $[1, 2, 0, 3]$          & $3.1617$            & $[]$  & $[]      $ \\
$S_{1,2}$ & $[3, 2, 0, 1]$    & $3.6619$      & $[3, 2, 0, 1]$          & $3.6619$            & $[]$  & $[(1, 4)]$ \\
$S_{1,3}$ & $[1, 0, 3, 2]$    & $3.6494$      & $[1, 0, 3, 2]$          & $3.6494$            & $[]$  & $[(2, 4)]$ \\
\end{tabular}
\end{center}
\vspace{1.5em}

\subsection{Iteration 2}

We choose $r_1 = 0.2351$ and $r_2 = 0.8262$ as random constants for this
iteration.

Applying the $v_2$ velocities calculated in iteration 1 to the positions in
iteration 1, we obtain the positions for iteration 2 and calculate new
velocities accordingly
\begin{center}
\begin{tabular}{lllllll}
          & \textbf{position} & \textbf{cost} & \textbf{lbest position} & \textbf{lbest cost} & $v_1$      & $v_2$            \\
$S_{2,1}$ & $[1, 2, 0, 3]$    & $3.1617$      & $[1, 2, 0, 3]$          & $3.1617$            & $[]      $ & $[]$             \\
$S_{2,2}$ & $[1, 2, 0, 3]$    & $3.1617$      & $[1, 2, 0, 3]$          & $3.1617$            & $[(1, 4)]$ & $[]$             \\
$S_{2,3}$ & $[1, 2, 3, 0]$    & $4.3288$      & $[1, 0, 3, 2]$          & $3.6494$            & $[(2, 4)]$ & $[(3,4), (3,4)]$ \\
\end{tabular}
\end{center}
\vspace{1.5em}

After two iterations, we have
$$S_\mathit{gbest} = [1, 2, 0, 3], \; cost(S_\mathit{gbest}) = 3.1617$$

\subsection{Ant Colony Optimization Algorithm} % Sandy

To model this problem with ACO, we will first transform it into a single-agent
TSP problem, and subsequently carry out ACS on the resulting graph.

For the purposes of ACS, the key insight for this transformation is a subtle
modification of the graph during search-time. Define the distance between any
two $depot$s to be 0, and, at first, connect each task node only to $depot_1$.

Upon visiting $depot_1$, ``teleport'' the ant to $depot_2$, connecting it to all
of the task nodes, and disconnecting $depot_1$. Upon doing this, update an
internal state variable $robot_{current}$, whose purpose it is to correctly
evaluate the $cost()$ function.

The first two iterations of performing ACS on this transformation on the sample
problem are fleshed out below:

\subsubsection{Iteration 1}

The starting node is $depot_1 = 4$.

$$
\eta = \sum_{n \in N_4} \frac{\uptau_{4n}^\alpha}{d_{4n}^\beta} = 3.5133
$$

\begin{align*}
p_{4i} &= \frac{\uptau_{4n}^\alpha d_{4i}^{-\beta}}{\eta} \\
\\
p_{41} &= 0.19155 \\
p_{42} &= 0.24881 \\
\mathbf{p_{43}} &= \mathbf{0.27501} \\
p_{44} &= 0.28464
\end{align*}

$$
\text{Tour} = \{4, 3\}
$$

% % %

$$
\eta = \sum_{n \in N_3} \frac{\uptau_{3n}^\alpha}{d_{3n}^\beta} = 2.6438
$$

\begin{align*}
p_{3i} &= \frac{\uptau_{3n}^\alpha d_{3i}^{-\beta}}{\eta} \\
\\
\mathbf{p_{31}} &= \mathbf{0.32551} \\
p_{32} &= 0.33063 \\
p_{34} &= 0.34386
\end{align*}

$$
\text{Tour} = \{4, 3, 1\}
$$

% % %

$$
\eta = \sum_{n \in N_1\setminus\{3\}} \frac{\uptau_{1n}^\alpha}{d_{1n}^\beta} = 1.5792
$$

\begin{align*}
p_{1i} &= \frac{\uptau_{1n}^\alpha d_{1i}^{-\beta}}{\eta} \\
\\
p_{12} &= 0.60423 \\
\mathbf{p_{14}} &= \mathbf{0.39577}
\end{align*}

$$
\text{Tour} = \{4, 3, 1, 4, 5\}
$$

Note that traveling to $depot_1 = 4$ has triggered the ant to automatically move to $depot_2 = 5$, and thus the ant now uses $robot_2$'s cost function.

% % %

$$
\mathbf{p_{52}} = \mathbf{1}
$$

$$
\text{Tour} = \{4, 3, 1, 4, 5, 2, 5\} \qquad
d_{tour} = 1.0210
$$

Update pheromones:

$$
\uptau_{ij} =
\begin{tabular}{r | c c c c c}
$i \setminus j$ & 1 & 2 & 3 & 4 & 5 \\
\hline
1 & $\emptyset$ & 0.90000 & 1.09916 & 1.09916 & 0.90000 \\
2 & 0.90000 & $\emptyset$ & 0.90000 & 0.90000 & 1.29833 \\
3 & 1.09916 & 0.90000 & $\emptyset$ & 1.09916 & 0.90000 \\
4 & 1.09916 & 0.90000 & 1.09916 & $\emptyset$ & 1.09916 \\
5 & 0.90000 & 1.29833 & 0.90000 & 1.09916 & $\emptyset$
\end{tabular}
$$



\subsubsection{Iteration 2}

$$
\eta = \sum_{n \in N_4} \frac{\uptau_{4n}^\alpha}{d_{4n}^\beta} = 3.4884
$$

\begin{align*}
p_{4i} &= \frac{\uptau_{4n}^\alpha d_{4i}^{-\beta}}{\eta} \\
\\
\mathbf{p_{41}} &= \mathbf{0.21204} \\
p_{42} &= 0.22552 \\
p_{43} &= 0.30444 \\
p_{44} &= 0.25800
\end{align*}

$$
\text{Tour} = \{4, 1\}
$$

% % %

$$
\eta = \sum_{n \in N_1} \frac{\uptau_{1n}^\alpha}{d_{1n}^\beta} = 2.5730
$$

\begin{align*}
p_{1i} &= \frac{\uptau_{1n}^\alpha d_{1i}^{-\beta}}{\eta} \\
\\
\mathbf{p_{42}} &= \mathbf{0.33376} \\
p_{43} &= 0.39924 \\
p_{44} &= 0.26699
\end{align*}

$$
\text{Tour} = \{4, 1, 2\}
$$

% % %

$$
\eta = \sum_{n \in N_2\setminus\{1\}} \frac{\uptau_{2n}^\alpha}{d_{2n}^\beta} = 1.5068
$$

\begin{align*}
p_{2i} &= \frac{\uptau_{2n}^\alpha d_{1i}^{-\beta}}{\eta} \\
\\
p_{23} &= 0.54054 \\
\mathbf{p_{24}} &= \mathbf{0.45946}
\end{align*}

$$
\text{Tour} = \{4, 1, 2, 4, 5\}
$$

% % %

\begin{align*}
\mathbf{p_{53}} &= \mathbf{1}
\end{align*}

$$
\text{Tour} = \{4, 1, 2, 4, 5, 3, 5\} \qquad d_{tour} = 0.8900
$$

$$
\uptau_{ij} =
\begin{tabular}{r | c c c c c}
$i \setminus j$ & 1 & 2 & 3 & 4 & 5 \\
\hline
1 & $\emptyset$ & 1.01450 & 0.98925 & 1.19375 & 0.81000 \\
2 & 1.01450 & $\emptyset$ & 0.81000 & 1.01450 & 1.16849 \\
3 & 0.98925 & 0.81000 & $\emptyset$ & 0.98925 & 1.21900 \\
4 & 1.19375 & 1.01450 & 0.98925 & $\emptyset$ & 1.19375 \\
5 & 0.81000 & 1.16849 & 1.21900 & 1.19375 & $\emptyset$
\end{tabular}
$$

\subsubsection{Result}

$$
\text{Tour}_{best} = \{4, 1, 2, 4, 5, 3, 5\} \qquad d_{best} = 0.8900
$$

\section{Performance Evaluation}

% Define some experiments (scenarios) to quantitatively evaluate the performance
% of your algorithm. Experiments must be run several cdot and average results
% should be reported

% Establish a set of evaluation metrics and run some experiments with different
% values of algorithm parameters to quantitatively and qualitatively assess the
% performance of the developed solution using different meta-heuristic
% optimization techniques. Students must identify the pros and cons of each
% technique and assess the quality of work as well as its fit with project
% objectives.

% Report your observation and interpret the obtained results. Suggest how to
% refine the implemented solutions to improve their performance.

% The implemented solutions should be tested against a set of well-defined
% evaluation metrics. These metrics may include, but are not limited to, the CPU
% time of the algorithm, number of iterations to converge, time per iteration,
% optimality (if the ground truth is known), etc.

% A number of experiments/scenarios should be conducted to quantitatively
% evaluate the performance of the proposed solutions. You should run each
% experiment several cdot and report the average results.

% Determine some evaluation metrics (time is a potentially useful candidate) Run
% some experiments with different values of algorithms parameters to
% quantitatively and qualitatively assess the performance of the developed
% solution Identify the pros and cons of each method

Each meta-heuristic will be evaluated quantitatively and qualitatively.

The following instances of MRTA will be studied:
\begin{enumerate}
\item \textbf{Small scale}: Five tasks and three robots
\item \textbf{Medium scale}: Fifteen tasks and five robots
\item \textbf{Small scale}: Fifty tasks and fifteen robots
\end{enumerate}

The different scenarios will allow for qualitative analysis on the scalability of meta-heuristic techniques and where they are best applied. Within each scenario, each technique can be compared using some quantitative metrics. Badreldin et al. \cite{Badreldin} identify two suitable measures: the computational time taken to find the best solution and the optimality of the best solution obtained by a meta-heuristic technique.

\section{Conclusions \& Recommendations}
% Report your observation and interpret obtained results. Briefly explain your
% research work, and suggest how to improve the implemented solutions

% Summarize the conclusion and future improvement. Explain how did you solve the
% problem, what problems were met? What did the results show? and how to refine
% the proposed solution? You may organize ideas using lists or numbered points,
% if appropriate, but avoid making your report into a check-list or a series of
% encrypted notes.

This paper has presented a comparative study of meta-heuristic algorithms used within an optimization based approach to solving the MRTA problem. Five meta-heuristics were considered: Tabu Search, Simulated Annealing, Genetic Algorithms, Particle Swarm optimization, and Ant Colony Optimization. RECAP RESULTS OF EXPERIMENTS.

\printbibliography

% Every report needs references; in fact, your failure to consult references for
% guidance may be considered negligence. On the other hand, when you include
% sentences, photos, drawings or figures from other sources in your report, the
% complete reference must be cited. Failure to do so is plagiarism, an academic
% infraction with serious consequences.

% Remember to cite anything you get from other sources
%  - Other research papers
%  - Drawings, charts, figures, etc.

% Failure to do so is plagiarism, an academic infraction with serious
% consequences. The complete references should be shown at the end of your
% report



% M. Clerc, “Discrete Particle Swarm Optimization,” in New Optimization Techniques in Engineering. Springer-Verlag, 2004.

\end{document}
